# Dokploy Deployment Configuration
# Copy this file to .env and fill in your actual values

# REQUIRED: Your domain name for public access
DOMAIN=your-domain.com

# -----------------------------------------------------------------------------
# Azure Blob Storage Integration (Optional)
# -----------------------------------------------------------------------------
# Enable or disable Azure upload feature.
AZURE_UPLOAD_ENABLED=false
#
# Credential modes (choose ONE):
# 1) Connection string (full access):
#    AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=...;AccountName=...;AccountKey=...;EndpointSuffix=core.windows.net
#    (Leave AZURE_BLOB_ACCOUNT_URL / AZURE_SAS_TOKEN empty)
# 2) Pre-generated SAS (no account key stored):
#    AZURE_BLOB_ACCOUNT_URL=https://<account>.blob.core.windows.net
#    AZURE_SAS_TOKEN=?sv=...  (with or without leading '?')
#    (Leave AZURE_STORAGE_CONNECTION_STRING empty)
#
# NOTE: Dynamic SAS generation (AZURE_GENERATE_SAS=true) REQUIRES a connection string
#       and is ignored when using a pre-generated SAS token.
AZURE_STORAGE_CONNECTION_STRING=
AZURE_BLOB_ACCOUNT_URL=
AZURE_SAS_TOKEN=
# Target container name (will be created if it does not exist)
AZURE_BLOB_CONTAINER_NAME=audio-files
# Optional prefix (subdirectory like path inside the container, omit or leave blank for root)
AZURE_BLOB_PREFIX=
# Generate a SAS URL alongside the blob_url (only valid when using connection string credentials)
AZURE_GENERATE_SAS=false
# SAS expiry in seconds (default 1 hour; only for dynamically generated SAS)
AZURE_SAS_EXPIRY_SECONDS=3600
# SAS permissions string (typical read-only: r)
AZURE_SAS_PERMISSIONS=r
# Delete local file after successful Azure upload (saves disk space)
AZURE_DELETE_LOCAL_AFTER_UPLOAD=false
# (Legacy / workflow) Table name if used externally (not required by API server)
AZURE_TABLE_NAME=DownloadLogs

# -----------------------------------------------------------------------------
# Core service configuration
# -----------------------------------------------------------------------------
YT_DLP_SERVER_HOST=0.0.0.0
YT_DLP_SERVER_PORT=8080

# -----------------------------------------------------------------------------
# Download / processing behavior
# -----------------------------------------------------------------------------
DEFAULT_AUDIO_FORMAT=mp3
DEFAULT_AUDIO_QUALITY=best          # best|high|medium|low (mapped to bitrates)
ALLOWED_FORMATS=mp3,m4a,ogg,wav
MAX_CONCURRENT_DOWNLOADS=3
MAX_FILE_AGE_HOURS=6                # Retention window before automatic cleanup
CLEANUP_INTERVAL_SECONDS=600        # How often cleanup loop runs
MIN_FREE_DISK_MB=100                # Readiness fails if below this free space
QUALITY_BITRATES=best=0,high=192,medium=128,low=64
ALLOWED_DOMAINS=youtube.com,youtu.be

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
# Global log level applied to application + yt-dlp + Azure SDK + urllib3
# Values: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Optional: n8n configuration (if using workflow automation)
# -----------------------------------------------------------------------------
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=password
N8N_PORT=5678